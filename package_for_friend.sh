#!/bin/bash

# üì¶ –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç—É —Ç–∞ –ø–µ—Ä–µ–¥–∞—á—ñ –¥—Ä—É–∑—è–º

echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
echo "‚ïë       üì¶ –£–ø–∞–∫–æ–≤–∫–∞ Mod Manager –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ           ‚ïë"
echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
echo ""

# –ù–∞–∑–≤–∞ –∞—Ä—Ö—ñ–≤—É
ARCHIVE_NAME="mod-manager-installer.tar.gz"
DATE=$(date +%Y%m%d)
ARCHIVE_WITH_DATE="mod-manager-installer-$DATE.tar.gz"

# –ö–æ–ª—å–æ—Ä–∏
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${BLUE}‚Ñπ${NC} –©–æ –±—É–¥–µ —É–ø–∞–∫–æ–≤–∞–Ω–æ:"
echo "  ‚úì –Ü–Ω—Å—Ç–∞–ª—è—Ü—ñ–π–Ω–∏–π —Å–∫—Ä–∏–ø—Ç (install.sh)"
echo "  ‚úì –í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ (src/, mod_manager_flutter/)"
echo "  ‚úì –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (requirements.txt, pubspec.yaml)"
echo "  ‚úì –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é (README, —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó)"
echo "  ‚úì –†–µ—Å—É—Ä—Å–∏ (assets/)"
echo ""

# –ü–∏—Ç–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
read -p "–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —É–ø–∞–∫–æ–≤–∫—É? (y/n): " -n 1 -r
echo
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "–°–∫–∞—Å–æ–≤–∞–Ω–æ."
    exit 1
fi

echo ""
echo -e "${BLUE}‚Ñπ${NC} –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Ä—Ö—ñ–≤—É..."

# –í–∏–∫–ª—é—á–∞—î–º–æ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω—ñ —Ñ–∞–π–ª–∏
tar -czf "$ARCHIVE_WITH_DATE" \
    --exclude='.git' \
    --exclude='__pycache__' \
    --exclude='*.pyc' \
    --exclude='.pytest_cache' \
    --exclude='node_modules' \
    --exclude='build' \
    --exclude='.dart_tool' \
    --exclude='*.log' \
    --exclude='mod_manager_flutter/.flutter-plugins-dependencies' \
    --exclude='mod_manager_flutter/linux/flutter/ephemeral' \
    install.sh \
    start.sh \
    run_flutter.sh \
    run_python.sh \
    quick_install.sh \
    api_server.py \
    requirements.txt \
    config.json \
    README*.md \
    INSTALL*.md \
    QUICK_START.txt \
    src/ \
    mod_manager_flutter/ \
    assets/ \
    2>/dev/null

if [ $? -eq 0 ]; then
    # –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∞–∫–æ–∂ –≤–µ—Ä—Å—ñ—é –±–µ–∑ –¥–∞—Ç–∏
    cp "$ARCHIVE_WITH_DATE" "$ARCHIVE_NAME"
    
    ARCHIVE_SIZE=$(du -h "$ARCHIVE_WITH_DATE" | cut -f1)
    
    echo ""
    echo -e "${GREEN}‚úì${NC} –ê—Ä—Ö—ñ–≤ —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ!"
    echo ""
    echo "  üì¶ –§–∞–π–ª: $ARCHIVE_WITH_DATE"
    echo "  üìè –†–æ–∑–º—ñ—Ä: $ARCHIVE_SIZE"
    echo "  üì¶ –ö–æ–ø—ñ—è: $ARCHIVE_NAME"
    echo ""
    echo -e "${YELLOW}üì§ –Ø–∫ –ø–µ—Ä–µ–¥–∞—Ç–∏ –¥—Ä—É–≥—É:${NC}"
    echo ""
    echo "  1. –í—ñ–¥–ø—Ä–∞–≤ —Ñ–∞–π–ª —á–µ—Ä–µ–∑:"
    echo "     - Google Drive / Dropbox"
    echo "     - Email (—è–∫—â–æ < 25 MB)"
    echo "     - USB —Ñ–ª–µ—à–∫—É"
    echo "     - –õ–æ–∫–∞–ª—å–Ω–∞ –º–µ—Ä–µ–∂–∞: python3 -m http.server"
    echo ""
    echo "  2. –î—Ä—É–≥ —Ä–æ–∑–ø–∞–∫–æ–≤—É—î:"
    echo "     tar -xzf $ARCHIVE_NAME"
    echo "     cd mod-manager"
    echo "     ./install.sh"
    echo ""
    echo "  3. –ê–±–æ –¥–∞–π —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é:"
    echo "     cat QUICK_START.txt"
    echo ""
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é –¥–ª—è –¥—Ä—É–≥–∞
    cat > "–Ü–ù–°–¢–†–£–ö–¶–Ü–Ø_–î–õ–Ø_–î–†–£–ì–ê.txt" << 'EOF'
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    üéÆ MOD MANAGER - –®–í–ò–î–ö–ï –í–°–¢–ê–ù–û–í–õ–ï–ù–ù–Ø
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

1. –†–û–ó–ü–ê–ö–£–ô –ê–†–•–Ü–í:
   tar -xzf mod-manager-installer.tar.gz
   cd mod-manager

2. –ó–ê–ü–£–°–¢–ò –Ü–ù–°–¢–ê–õ–Ø–¢–û–†:
   ./install.sh

3. –î–û–ß–ï–ö–ê–ô–°–Ø –ó–ê–í–ï–†–®–ï–ù–ù–Ø (5-10 —Ö–≤–∏–ª–∏–Ω)

4. –ù–ê–õ–ê–®–¢–£–ô config.json:
   nano config.json
   –í–∫–∞–∂–∏ —à–ª—è—Ö –¥–æ –ø–∞–ø–∫–∏ Mods –≥—Ä–∏

5. –ó–ê–ü–£–°–¢–ò:
   ./start.sh

–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ: QUICK_START.txt –∞–±–æ INSTALL_GUIDE.md

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
EOF
    
    echo -e "${GREEN}‚úì${NC} –°—Ç–≤–æ—Ä–µ–Ω–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é: –Ü–ù–°–¢–†–£–ö–¶–Ü–Ø_–î–õ–Ø_–î–†–£–ì–ê.txt"
    echo ""
    
    # –ü—Ä–æ–ø–æ–Ω—É—î–º–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ README –¥–ª—è –∞—Ä—Ö—ñ–≤—É
    cat > "README_–ê–†–•–Ü–í.txt" << 'EOF'
üéÆ MOD MANAGER - –ê–†–•–Ü–í –î–õ–Ø –£–°–¢–ê–ù–û–í–ö–ò

–¶–µ–π –∞—Ä—Ö—ñ–≤ –º—ñ—Å—Ç–∏—Ç—å –ø–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é Mod Manager –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä–æ–º.

–®–í–ò–î–ö–ò–ô –°–¢–ê–†–¢:
===============

1. –†–æ–∑–ø–∞–∫—É–π –∞—Ä—Ö—ñ–≤:
   tar -xzf mod-manager-installer.tar.gz

2. –ü–µ—Ä–µ–π–¥–∏ –≤ –ø–∞–ø–∫—É:
   cd mod-manager

3. –ó–∞–ø—É—Å—Ç–∏ —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä:
   ./install.sh

4. –°–ª—ñ–¥—É–π —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º –Ω–∞ –µ–∫—Ä–∞–Ω—ñ

–í–ò–ú–û–ì–ò:
========
- Linux (Ubuntu, Debian, Arch, Fedora)
- –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- ~2 GB –≤—ñ–ª—å–Ω–æ–≥–æ –º—ñ—Å—Ü—è

–î–û–ö–£–ú–ï–ù–¢–ê–¶–Ü–Ø:
=============
- QUICK_START.txt - –®–≤–∏–¥–∫–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫
- INSTALL_GUIDE.md - –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
- README_INSTALLER.md - –ü–æ–≤–Ω–∏–π README

–ü–Ü–î–¢–†–ò–ú–ö–ê:
==========
GitHub: https://github.com/yourusername/mod-manager
EOF
    
    echo -e "${GREEN}‚úì${NC} –°—Ç–≤–æ—Ä–µ–Ω–æ README_–ê–†–•–Ü–í.txt"
    echo ""
    echo -e "${GREEN}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${NC}"
    echo -e "${GREEN}    ‚úì –ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–µ–∫—Ç —É–ø–∞–∫–æ–≤–∞–Ω–æ —ñ –≥–æ—Ç–æ–≤–∏–π –¥–æ –ø–µ—Ä–µ–¥–∞—á—ñ   ${NC}"
    echo -e "${GREEN}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${NC}"
    
else
    echo ""
    echo -e "${RED}‚úó${NC} –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∞—Ä—Ö—ñ–≤—É"
    exit 1
fi
