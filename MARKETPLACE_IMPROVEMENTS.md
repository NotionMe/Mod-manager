# –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—É

## üéØ –í–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

### 1. –ü–æ–¥–≤—ñ–π–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (Windows + Linux)
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –º–æ–¥–∞ –±—Ä–∞—É–∑–µ—Ä —ñ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ–¥–Ω–æ—á–∞—Å–Ω–æ —Å–∫–∞—á—É–≤–∞–ª–∏ —Ñ–∞–π–ª, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏–ª–æ –¥–æ –¥–≤–æ—Ö –∫–æ–ø—ñ–π.

**–†—ñ—à–µ–Ω–Ω—è**: 
- –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω—å –Ω–∞ –∞—Ä—Ö—ñ–≤–∏ (.zip, .rar, .7z) —É `shouldOverrideUrlLoading`
- –¢–µ–ø–µ—Ä –±—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫—É—î –≤–ª–∞—Å–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (`NavigationActionPolicy.CANCEL`)
- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–≥—Ä–∞–º—É –∑ –¥—ñ–∞–ª–æ–≥–æ–º –≤–∏–±–æ—Ä—É
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å –æ–¥–∏–Ω –¥—ñ–∞–ª–æ–≥ —ñ –æ—Ç—Ä–∏–º—É—î –æ–¥–∏–Ω —Ñ–∞–π–ª ‚úÖ

### 2. –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Linux
**–©–æ –¥–æ–¥–∞–Ω–æ**:
- ‚úÖ WebView –ø—Ä–∞—Ü—é—î –Ω–∞ Linux (—á–µ—Ä–µ–∑ webkit2gtk)
- ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥—ñ–≤ –Ω–∞ Linux
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∞—Ä—Ö—ñ–≤—ñ–≤ .zip, .rar, .7z —á–µ—Ä–µ–∑ p7zip
- ‚úÖ SSL certificate handling –¥–ª—è Linux
- ‚úÖ –£—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—É –¥–æ—Å—Ç—É–ø–Ω—ñ —è–∫ –Ω–∞ Windows

**–ó–º—ñ–Ω–∏ –≤ –∫–æ–¥—ñ**:
```dart
// –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º
bool get _isLinux => !kIsWeb && Platform.isLinux;
bool get _isDesktop => _isWindows || _isLinux;
bool get _isWebViewSupported => _isDesktop;

// –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ –º–µ—Ç–æ–¥–∏ WebView
_buildDesktopWebView()  // –∑–∞–º—ñ—Å—Ç—å _buildWindowsWebView()
```

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–ª—ñ–∫–∞—î –Ω–∞ –º–æ–¥ (.zip/.rar/.7z)
2. `shouldOverrideUrlLoading` –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î URL
3. –ü–æ–∫–∞–∑—É—î—Ç—å—Å—è –¥—ñ–∞–ª–æ–≥: "–¢—ñ–ª—å–∫–∏ —Å–∫–∞—á–∞—Ç–∏" / "–°–∫–∞—á–∞—Ç–∏ —ñ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏"
4. –ë—Ä–∞—É–∑–µ—Ä –æ—Ç—Ä–∏–º—É—î `CANCEL` ‚Üí –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î
5. –ü—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —á–µ—Ä–µ–∑ `_handleDownload` ‚Üí –æ–¥–∏–Ω —Ñ–∞–π–ª ‚úÖ

### –û—á–∏—â–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤
- –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤—Ü—ñ: –∞—Ä—Ö—ñ–≤ —ñ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è —ñ–º–ø–æ—Ä—Ç—É
- –ü—Ä–∏ "—Ç—ñ–ª—å–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏": –∞—Ä—Ö—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ `AppData/downloads`
- –¢–∏–º—á–∞—Å–æ–≤—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó (`systemTemp`) –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–∏—Å—Ç—è—Ç—å—Å—è

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

#### SSL Certificates
```dart
// Windows —ñ Linux - –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤—Å—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏
if (Platform.isWindows || Platform.isLinux) {
  httpClient.badCertificateCallback = (cert, host, port) => true;
}
```

#### 7-Zip
- **Windows**: –®—É–∫–∞—î –≤ `Program Files` –∞–±–æ —á–µ—Ä–µ–∑ `where 7z`
- **Linux**: –®—É–∫–∞—î `7z`, `7za`, `7zr` —á–µ—Ä–µ–∑ `which`

## üì¶ –°–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–º–æ–≥–∏

### Linux
```bash
# WebKit –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
sudo apt-get install webkit2gtk-4.0 libwebkit2gtk-4.0-dev

# 7-Zip –¥–ª—è –∞—Ä—Ö—ñ–≤—ñ–≤
sudo apt-get install p7zip-full
```

### Windows
- –í–±—É–¥–æ–≤–∞–Ω–∏–π WebView2 (Edge)
- 7-Zip (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è .rar —ñ .7z)

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞ Windows:
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å
2. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π –º–æ–¥
3. –ú–∞—î –±—É—Ç–∏ **–æ–¥–∏–Ω** –¥—ñ–∞–ª–æ–≥ –ø—Ä–æ–≥—Ä–∞–º–∏
4. –ú–∞—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏—Å—å **–æ–¥–∏–Ω** —Ñ–∞–π–ª

### –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞ Linux:
1. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ webkit2gtk —ñ p7zip
2. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É
3. –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –º–∞—î –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—å
4. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î —è–∫ –Ω–∞ Windows

## üìù –ó–º—ñ–Ω–µ–Ω—ñ —Ñ–∞–π–ª–∏

- `lib/screens/marketplace_screen.dart` - –æ—Å–Ω–æ–≤–Ω—ñ –∑–º—ñ–Ω–∏
- `LINUX_MARKETPLACE_SETUP.md` - —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è Linux
- `MARKETPLACE_IMPROVEMENTS.md` - —Ü–µ–π –¥–æ–∫—É–º–µ–Ω—Ç

## ‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

**–ü—Ä–æ–±–ª–µ–º–∞**: 100 –ú–ë –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–ª–æ—Å—å 2-3 —Ö–≤–∏–ª–∏–Ω–∏ –∑–∞–º—ñ—Å—Ç—å ~10 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ —à–≤–∏–¥–∫–æ—Å—Ç—ñ 10 –ú–ë/—Å.

**–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä –æ–Ω–æ–≤–ª—é–≤–∞–≤—Å—è –Ω–∞ **–∫–æ–∂–Ω–æ–º—É chunk'—ñ** (–∫–æ–∂–Ω—ñ ~8-16 KB), –≤–∏–∫–ª–∏–∫–∞—é—á–∏ –ø–µ—Ä–µ–±—É–¥–æ–≤—É UI —Ç–∏—Å—è—á—ñ —Ä–∞–∑—ñ–≤, —â–æ –≥–∞–ª—å–º—É–≤–∞–ª–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

**–†—ñ—à–µ–Ω–Ω—è**:
```dart
// –ë–£–õ–û: –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ –∫–æ–∂–Ω–æ–º—É chunk (–ø–æ–≤—ñ–ª—å–Ω–æ)
await response.listen((chunk) {
  received += chunk.length;
  sink.add(chunk);
  progressNotifier.value = received / total;  // ‚ùå –¢–∏—Å—è—á—ñ UI updates!
}).asFuture();

// –°–¢–ê–õ–û: –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 256 KB (—à–≤–∏–¥–∫–æ)
const progressUpdateThreshold = 262144; // 256 KB
if (received - lastProgressUpdate >= progressUpdateThreshold) {
  progressNotifier.value = received / total;  // ‚úÖ ~400 updates –¥–ª—è 100MB
  lastProgressUpdate = received;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –®–≤–∏–¥–∫—ñ—Å—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–±—ñ–ª—å—à–µ–Ω–∞ –≤ **10-20 —Ä–∞–∑—ñ–≤**
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä –≤—Å–µ —â–µ –ø–ª–∞–≤–Ω–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è
- ‚úÖ –î–æ–¥–∞–Ω–æ `sink.flush()` –¥–ª—è –∫—Ä–∞—â–æ—ó –±—É—Ñ–µ—Ä–∏–∑–∞—Ü—ñ—ó
- ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

## üöÄ –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –ü—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä –ø—Ä–∏ —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—ñ –≤–µ–ª–∏–∫–∏—Ö –∞—Ä—Ö—ñ–≤—ñ–≤
- [ ] –ö–µ—à—É–≤–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –º–æ–¥—ñ–≤
- [ ] –Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å
- [ ] –§—ñ–ª—å—Ç—Ä–∏ —Ç–∞ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ñ
- [ ] –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ macOS (–ø–æ—Ç—Ä–µ–±—É—î —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è)
